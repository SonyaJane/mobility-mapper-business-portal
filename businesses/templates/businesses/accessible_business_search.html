{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/accessible_business_search.css' %}">
{% endblock %}

{% block page_title %}Accessible Businesses{% endblock %}

{% block content %}
<div class="search-container row">

  <!-- text search and map container (LHS in md+) -->
  <div id="search-map" class="col-md-6 p-0 d-flex flex-column">

    <!-- Text search -->
    <div id="text-search" class="p-1 pe-md-0 position-relative">
      <input type="text" id="business-search" class="form-control pr-5" placeholder="Search for accessible businesses">
      <!-- Buttons container: search & clear -->
      <div id="search-buttons" class="position-absolute top-50 translate-middle-y d-flex">
        <button type="button" id="search-btn" class="btn d-md-none" aria-label="Run search">
          <i class="bi bi-search"></i>
        </button>
        <button type="button" id="clear-search" class="btn box-shadow" aria-label="Clear search">
          <i class="bi bi-x"></i>
        </button>
      </div>
    </div>

    <!-- Map container -->
    <div id="map">

      <!-- Button to show list view (initially hidden) -->
      <button id="show-list-view-btn" class="btn btn-outline-secondary hide d-md-none" aria-label="Show list view">
        <i class="bi bi-list fs-5 pe-2"></i> Show list view 
      </button>

        <!-- Overlay for detailed business info -->
      <div id="info-overlay" class="info-overlay hide d-md-none">
        <div class="info-overlay-content">
          <button id="info-overlay-close" class="info-overlay-close" aria-label="Close overlay">Ã—</button>
          <div id="info-overlay-body"></div>
        </div>
      </div>

    </div>

  </div>

  <!-- search results section - (RHS in md+, overlays on mobile)-->
  <div id="results-container" class="hide col-md-6 p-0">
        
    <!-- Accessibility features filter -->   
    <div class="sticky-top bg-white d-flex flex-column p-1 pt-0 pt-md-1">  
      
      <div id="accessibility-filters" class="pb-1 pb-md-0 position-relative">  
        <select id="accessibility-select" class="form-select flex-grow-1" multiple>
            {% for feature in accessibility_features %}
              <option value="{{ feature.name }}">{{ feature.name }}</option>
            {% endfor %}
          </select>
        <!-- Clear all selections -->
        <button type="button" id="clear-accessibility" class="btn btn-link position-absolute top-50 end-0 translate-middle-y px-2 hide" aria-label="Clear all filters">
          <i class="bi bi-x fs-5 text-secondary"></i>
        </button>
      </div>

        <!-- Show map view button (mobile screens only) -->
        <button type="button" id="show-map-view-btn" class="btn btn-outline-secondary d-md-none" aria-label="Show map view">
          <i class="bi bi-map fs-5 pe-2"></i> View results on map    
        </button>
    </div> 

    <ul id="results-list" class="list-group p-1 pt-0"></ul>
  </div>
    
</div>
{% endblock %}

{% block extra_js %}
<script type="module" src="{% static 'js/accessible_business_search.js' %}"></script>
{% endblock %}
