{% extends "base.html" %}

{% load static %}

{% block page_title %}Accessibility Verification Report{% endblock %}


{% block content %}
<div class="content-container p-3">

  <div class="my-4">
    <h4 class="text-center">
      <span class="d-block">Verification of the accessibility features of</span>
      <span class="fw-bold text-primary py-2 d-block">{{ verification.business.business_name }}</span>
      {% if show_wheeler_name %}
      <span class="d-block">by</span>
      <span class="fw-bold text-primary py-2 d-block">{{ verification.wheeler.get_full_name|default:verification.wheeler.username }}</span>
      <span class="d-block fs-6">(your name is only visible to you)</span>
      {% endif %}
    </h4>
  </div>

  <div class="row pt-3 g-2">
    <div class="col-md-4">
      <div class="border rounded p-3 h-100">
        <h5>Address visited:</h5>
        <p>{{ verification.business.address }}</p>
      </div>
    </div>
    <div class="col-md-4">
      <div class="border rounded p-3 h-100">
        <h5>Date of Verification:</h5>
        <p>{{ verification.date_verified|date:"F j, Y" }}</p>
      </div>
    </div>
    <div class="col-md-4">
      <div class="border rounded p-3 h-100">
        <h5>Mobility Device Used</h5>
        <p>{{ verification.get_mobility_device_display }}</p>
      </div>
    </div>
  </div>
  
  <div class="row my-0 g-2">
    <div class="col-md-6">
      <div class="border rounded p-3 h-100">
      <h5>Accessibility Features Confirmed</h5>
      <ul>
        {% for feature in confirmed_features %}
          <li>{{ feature.name }}</li>
        {% empty %}
          <li>No confirmed features recorded.</li>
        {% endfor %}
      </ul>
      </div>
    </div>
    <div class="col-md-6">
      <div class="border rounded p-3 h-100">
      <h5>Additional Features Found</h5>
      <ul>
        {% for feature in verification.additional_features.all %}
          <li>{{ feature.name }}</li>
        {% empty %}
          <li>No additional features reported.</li>
        {% endfor %}
      </ul>
      </div>
    </div>
  </div>

  <div class="row mb-2 mt-0 g-2">
    <div class="col-md-6">
      <div class="border rounded h-100">
        <div class="p-3">      
          <h5 class="mb-3">Feature Photos</h5>
          <div id="featurePhotosCarousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
              {% for item in feature_photos_list %}
                <div class="carousel-item{% if forloop.first %} active{% endif %}">
                  <img src="{{ item.url }}" class="d-block w-100 rounded border" alt="{{ item.feature }} photo">
                  <div class="carousel-caption d-none d-md-block">
                    <h5 class="bg-dark bg-opacity-50 rounded px-2">{{ item.feature.name }}</h5>
                  </div>
                </div>
              {% endfor %}
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#featurePhotosCarousel" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#featurePhotosCarousel" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="border rounded h-100">
        <div class="p-3">      
          <h5 class="mb-3">Other Photos Submitted</h5>
          {% if other_photo_urls %}
          <div id="otherPhotosCarousel" class="carousel slide" data-bs-ride="carousel" data-bs-wrap="false">
            <div class="carousel-inner">
              {% for url in other_photo_urls %}
                <div class="carousel-item{% if forloop.first %} active{% endif %}">
                  <img src="{{ url }}" class="d-block w-100 rounded border" alt="Verification Photo">
                </div>
              {% endfor %}
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#otherPhotosCarousel" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#otherPhotosCarousel" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
          </div>
          {% else %}
            <p>No photos submitted.</p>
          {% endif %}
        </div>
      </div>
    </div>

  </div>

  <div class="border rounded mx-1 mb-2">
    <div class="p-3">
      <h5 class="mb-3">Wheeler's Comments</h5>
      <div class="border p-3 bg-light">{{ verification.comments|linebreaks }}</div>
    </div>
  </div>
{% endblock %}
